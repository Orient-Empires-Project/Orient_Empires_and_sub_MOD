namespace = great_misit
# author: 糜三小姐
# 0001- interactions
# 1000- become great misit
great_misit.0001 = {
	type = character_event
	title = great_misit.0001.t
	desc = great_misit.0001.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	immediate = {
		random_knight = {
			limit = {
				is_adult = yes
			}
			save_scope_as = rando
		}
	}
	left_portrait = scope:recipient
	right_portrait = scope:rando
	option = {
		name = great_misit.0001.a
		scope:recipient = {
			death = {
				death_reason = death_duel
				killer = scope:rando
			}
		}
	}
}

great_misit.0002 = {
	type = character_event
	title = great_misit.0002.t
	desc = great_misit.0002.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:secondary_actor
	right_portrait = scope:actor
	option = {
		name = great_misit.0002.a
		add_pressed_claim = scope:secondary_actor.primary_title
		vassal_contract_set_obligation_level = {
			type = war_declaration_rights
			level = 1
		}
		hidden_effect = { set_subject_contract_modification_blocked = no }
	}
}

great_misit.0003 = {
	type = character_event
	title = great_misit.0003.t
	desc = great_misit.0003.desc
	theme = realm
	override_background = {
		reference = throne_room
	}

	left_portrait = scope:actor
	right_portrait = scope:recipient
	option = {
		name = great_misit.0003.a
		create_title_and_vassal_change = {
			type = usurped
			save_scope_as = change
			add_claim_on_loss = no
		}
		scope:target = {
			change_title_holder = {
				holder = scope:actor
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change
	}
}
great_misit.0004 = {
	type = character_event
	title = great_misit.0004.t
	desc = great_misit.0004.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:secondary_actor
	right_portrait = scope:recipient
	option = {
		name = great_misit.0004.a
		scope:recipient = { 
			if = { 
				limit = { is_married = yes }
				primary_spouse = {
					save_scope_as = recipient_spouse
				}
				divorce_effect = {
					DIVORCER = scope:recipient
					DIVORCEE = scope:recipient_spouse
				}
			}	
			marry = scope:secondary_actor 
		}
	}
}
great_misit.0005 = {
	type = character_event
	title = great_misit.0005.t
	desc = great_misit.0005.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:actor
	right_portrait = scope:recipient
	option = {
		name = great_misit.0005.a
		scope:actor = { 
			set_relation_lover = scope:recipient
			had_sex_with_effect = {
				CHARACTER = scope:recipient
				PREGNANCY_CHANCE = pregnancy_chance
			}
		}
		scope:recipient = { 
			set_relation_lover = scope:actor			
		}
	}
}
great_misit.0006 = {
	type = character_event
	title = great_misit.0006.t
	desc = great_misit.0006.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:secondary_actor
	right_portrait = scope:recipient
	option = {
		name = great_misit.0006.a
		scope:recipient = {
			send_interface_toast = {
				title = designate_heir_interaction_notification

				left_icon = scope:actor					
				right_icon = scope:secondary_actor

				set_designated_heir_unsafe = scope:secondary_actor
			}
		}
		scope:recipient = {
			set_designated_heir_unsafe = scope:secondary_actor
		}
		scope:recipient.primary_title = {
			set_designated_heir_unsafe = scope:secondary_actor
		}
	}
}

great_misit.0007 = {
	type = character_event
	title = great_misit.0007.t
	desc = great_misit.0007.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:secondary_actor
	right_portrait = scope:recipient
	option = {
		name = great_misit.0007.a
		scope:actor = {
			had_sex_with_effect = {
				CHARACTER = scope:secondary_actor
				PREGNANCY_CHANCE = pregnancy_chance
			}
		}
	}
}

great_misit.0008 = {
	type = character_event
	title = great_misit.0008.t
	desc = great_misit.0008.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:actor
	right_portrait = scope:recipient
	option = {
		name = great_misit.0008.a
		scope:actor = {
			add_hook = {
				target = scope:recipient
				type = favor_hook
			}
		}
	}
}
great_misit.0009 = {
	type = character_event
	title = great_misit.0009.t
	desc = great_misit.0009.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:actor
	right_portrait = scope:recipient
	option = {
		name = great_misit.0009.a
		scope:recipient = {
			send_interface_toast = {
				title = designate_heir_interaction_notification

				left_icon = scope:recipient					
				right_icon = scope:actor

				set_designated_heir_unsafe = scope:actor
				change_influence_or_prestige = { VALUE = -1000 }
			} 
		}
	}
}
great_misit.0010 = {
	type = character_event
	title = great_misit.0010.t
	desc = great_misit.0010.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:secondary_actor
	right_portrait = scope:recipient
	option = {
		name = great_misit.0010.a
		scope:recipient = {
			add_courtier = scope:secondary_actor 
		}
		scope:actor = {
			add_hook = {
				target = scope:secondary_actor
				type = favor_hook
			}
		}
	}
}
great_misit.0011 = {
	type = character_event
	title = great_misit.0011.t
	desc = great_misit.0011.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:secondary_actor
	right_portrait = scope:recipient

	option = {
		name = great_misit.0011.a
		scope:recipient = {
			add_courtier = scope:secondary_actor 
		}
		if = {
			limit = {
				scope:secondary_actor = {
					use_shiyue_relation = no
				}
			}
			scope:recipient = {
				set_relation_lover = scope:secondary_actor
			}
		}
		else_if = {
			limit = {
				scope:secondary_actor = {
					NOT = {
						has_relation_shiyuezhe = scope:recipient
					}
				}
			}
			scope:recipient = {
				set_relation_hunjian = scope:secondary_actor
			}
		}
		scope:recipient = {
			had_sex_with_effect = {
				CHARACTER = scope:secondary_actor
				PREGNANCY_CHANCE = pregnancy_chance
			}
		}
		scope:actor = {
			add_hook = {
				target = scope:secondary_actor
				type = favor_hook
			}
		}
		ai_chance = {
			base = 1
		}
	}
	option = {
		name = great_misit.0011.b
		ai_chance = {
			base = 0
		}
	}
}

great_misit.0012 = { #狩猎僭越
	type = character_event
	title = great_misit.0012.t
	desc = great_misit.0012.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	trigger = {
		great_misit_event_trigger = yes
	}
	immediate = {
		save_scope_as = great_misit
		liege = {
			save_scope_as = great_misit_liege
		}
	}
	left_portrait = scope:great_misit
	right_portrait = scope:great_misit_liege
	option = {
		name = great_misit.0012.a
		duel = {
			skill = prowess
			target = scope:great_misit_liege
			40 = {
				desc = great_misit.0012.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0012.a.great
					scope:great_misit = {
						add_misit_power = { VALUE = 30 }
					}
					scope:great_misit_liege = {
						change_influence_or_prestige = { VALUE = -200 }
					}
				}
			}
			60 = {	
				desc = great_misit.0012.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
				}
				min = 10
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0012.a.poor
					scope:great_misit = {
						add_misit_power = { VALUE = -20 }
						change_influence_or_prestige = { VALUE = -100 }
					}
					scope:great_misit_liege = {
						change_influence_or_prestige = { VALUE = 300 }
					}
				}
			}
		}
	}
	option = {
		name = great_misit.0012.b
		change_influence_or_prestige = { VALUE = 100 }
	}
}

great_misit.0013 = { #处理幕臣
	type = character_event
	title = great_misit.0013.t
	desc = great_misit.0013.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	trigger = {
		great_misit_event_trigger = yes
	}
	immediate = {
		save_scope_as = great_misit
		liege = {
			save_scope_as = great_misit_liege
		}
	}
	left_portrait = scope:great_misit
	right_portrait = scope:great_misit_liege
	option = {
		name = great_misit.0013.a
		duel = {
			skill = intrigue
			target = scope:great_misit_liege
			40 = {
				desc = great_misit.0013.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0013.a.great
					scope:great_misit = {
						add_misit_power = { VALUE = 30 }
					}
					scope:great_misit_liege = {
						change_influence_or_prestige = { VALUE = -200 }
					}					
				}
			}
			60 = {	
				desc = great_misit.0013.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -4
				}
				min = 20
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0013.a.poor
					scope:great_misit = {
						add_misit_power = { VALUE = -20 }
						change_influence_or_prestige = { VALUE = -100 }
					}
					scope:great_misit_liege = {
						change_influence_or_prestige = { VALUE = 300 }
					}					
				}
			}
		}
	}
	option = {
		name = great_misit.0013.b
	}
}

great_misit.0014 = { #宫相与舰娘领主
	type = character_event
	title = great_misit.0014.t
	desc = great_misit.0014.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	trigger = {
		great_misit_event_trigger = yes
		any_vassal = {
			always = yes
		}
	}
	left_portrait = scope:great_misit
	right_portrait = scope:first
	immediate = {
		random_vassal = {
			limit = {
				#warshipgirl_trigger = yes
			}
			save_scope_as = first
		}
		save_scope_as = great_misit
		liege = {
			save_scope_as = great_misit_liege
		}
	}
	option = {
		name = great_misit.0014.a
		add_misit_power = { VALUE = 20 }
		had_sex_with_effect = {
			CHARACTER = scope:first
			PREGNANCY_CHANCE = pregnancy_chance
		}
		scope:first = {
			change_influence_or_prestige = { VALUE = 200 }
		}
	}
	option = {
		name = great_misit.0014.b
		add_misit_power = { VALUE = 10 }
		scope:first = {
			change_influence_or_prestige = { VALUE = 50 }
		}
	}
}

great_misit.0015 = { #君主就是宫相的狗
	type = character_event
	title = great_misit.0015.t
	desc = great_misit.0015.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	immediate = {
		save_scope_as = great_misit
		liege = {
			save_scope_as = great_misit_liege
		}
	}
	left_portrait = scope:great_misit
	right_portrait = scope:great_misit_liege
	trigger = {
		great_misit_event_trigger = yes
	}
	option = {
		name = great_misit.0015.a
		duel = {
			skill = diplomacy
			target = scope:great_misit_liege
			50 = {
				desc = great_misit.0015.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0015.a.great
					scope:great_misit = {
						add_misit_power = { VALUE = 30 }
					}
					scope:great_misit_liege = {
						change_influence_or_prestige = { VALUE = -200 }
					}					
				}
			}
			50 = {	
				desc = great_misit.0015.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -4
				}
				min = 0
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0015.a.poor
					scope:great_misit = {
						add_misit_power = { VALUE = -20 }
						change_influence_or_prestige = { VALUE = -300 }
					}					
				}
			}
		}
	}
	option = {
		name = great_misit.0015.b
		change_influence_or_prestige = { VALUE = 100 }
	}
}

great_misit.0016 = { #僭越法
	type = character_event
	title = great_misit.0016.t
	desc = great_misit.0016.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	immediate = {
		save_scope_as = great_misit
		liege = {
			save_scope_as = great_misit_liege
		}
	}
	left_portrait = scope:great_misit
	right_portrait = scope:great_misit_liege
	trigger = {
		great_misit_event_trigger = yes
	}
	option = {
		name = great_misit.0016.a
		duel = {
			skill = learning
			target = scope:great_misit_liege
			40 = {
				desc = great_misit.0016.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0016.a.great
					scope:great_misit = {
						add_misit_power = { VALUE = 30 }
					}
					scope:great_misit_liege = {
						change_influence_or_prestige = { VALUE = -300 }
					}					
				}
			}
			60 = {	
				desc = great_misit.0016.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -4
				}
				min = 20
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0016.a.poor
					scope:great_misit = {
						add_misit_power = { VALUE = -20 }
						change_influence_or_prestige = { VALUE = -300 }
					}					
				}
			}
		}
	}
}

great_misit.0017 = { #狗脚朕
	type = character_event
	title = great_misit.0017.t
	desc = great_misit.0017.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	trigger = {
		great_misit_event_trigger = yes
	}
	immediate = {
		save_scope_as = great_misit
		liege = {
			save_scope_as = great_misit_liege
		}
		random_knight = {
			save_scope_as = knight
		}	
	}
	left_portrait = scope:knight
	right_portrait = scope:great_misit_liege
	option = {
		name = great_misit.0017.a
		duel = {
			skill = diplomacy
			target = scope:great_misit_liege
			30 = {
				desc = great_misit.0017.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 5
				}
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0017.a.great
					scope:great_misit = {
						add_misit_power = { VALUE = 50 }
					}
					scope:great_misit_liege = {
						change_influence_or_prestige = { VALUE = -1000 }
					}					
				}
			}
			70 = {	
				desc = great_misit.0017.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -5
				}
				min = 20
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0017.a.poor
					scope:great_misit = {
						add_misit_power = { VALUE = -50 }
						change_influence_or_prestige = { VALUE = -1000 }
					}					
				}
			}
		}
	}
}

great_misit.0018 = { #代天子征伐
	type = character_event
	title = great_misit.0018.t
	desc = great_misit.0018.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:great_misit
	right_portrait = scope:great_misit_liege
	trigger = {
		great_misit_event_trigger = yes
		liege = {
			is_at_war = yes
		}
	}
	immediate = {
		save_scope_as = great_misit
		liege = {
			save_scope_as = great_misit_liege
		}	
	}
	option = {
		name = great_misit.0018.a
		duel = {
			skill = martial
			target = scope:great_misit_liege
			60 = {
				desc = great_misit.0018.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0018.a.great
					scope:great_misit = {
						add_misit_power = { VALUE = 30 }
					}
					scope:great_misit_liege = {
						change_influence_or_prestige = { VALUE = -100 }
					}					
				}
			}
			40 = {	
				desc = great_misit.0018.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -4
				}
				min = 20
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0018.a.poor
					scope:great_misit = {
						add_misit_power = { VALUE = -30 }
						change_influence_or_prestige = { VALUE = -100 }
					}					
				}
			}
		}
	}
}

great_misit.0019 = { #宫相的心意
	type = character_event
	title = great_misit.0019.t
	desc = great_misit.0019.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:great_misit
	right_portrait = scope:first
	trigger = {
		great_misit_event_trigger = yes
		liege = {
			any_vassal = {
				is_available_adult = yes
				this != ROOT
				# is_hm_religion = no
			}
		}
	}
	immediate = {
		save_scope_as = great_misit
		liege = {
			save_scope_as = great_misit_liege
			random_vassal = {
				limit = {
					is_available_adult = yes
					this != ROOT
				}
				save_scope_as = first
			}
		}	
	}
	option = {
		name = great_misit.0019.a
		duel = {
			skill = diplomacy
			target = scope:great_misit_liege
			60 = {
				desc = great_misit.0019.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0019.a.great
					scope:great_misit = {
						add_misit_power = { VALUE = 30 }
					}
					scope:great_misit_liege = {
						change_influence_or_prestige = { VALUE = -100 }
					}					
				}
			}
			40 = {	
				desc = great_misit.0019.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -4
				}
				min = 20
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0019.a.poor
					scope:great_misit = {
						add_misit_power = { VALUE = -30 }
						change_influence_or_prestige = { VALUE = -100 }
					}					
				}
			}
		}
	}
}

great_misit.0020 = {
	type = character_event
	hidden = yes

	trigger = {
		has_father = yes
		father = {
			highest_held_title_tier >= tier_kingdom
			any_vassal = {
				has_relation_great_misit_liege = prev
			}
		}
		mother = {
			house = {
				any_house_member = {
					is_great_misit_trigger = yes
					#is_ai = no
				}
			}
		}
	}
	immediate = {
		father = {
			save_scope_as = great_misit_liege
			random_vassal = {
				limit = {
					has_relation_great_misit_liege = scope:great_misit_liege
				}
				save_scope_as = great_misit
				trigger_event = {
					id = great_misit.0021
					days = 3
				}
			}
		}
	}
}

great_misit.0021 = { #外戚的威势
	type = character_event
	title = great_misit.0021.t
	desc = great_misit.0021.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:mother
	right_portrait = scope:child
	option = {
		name = great_misit.0021.a
		add_misit_power = { VALUE = 30 }
	}
}

great_misit.0022 = {
	type = character_event
	hidden = yes
	trigger = {
		highest_held_title_tier >= tier_kingdom
		any_vassal = {
			has_relation_great_misit_liege = ROOT
		}
		scope:spouse = {
			house ?= {
				this != ROOT.house
				any_house_member = {
					this != ROOT
					is_vassal_of = ROOT
					has_relation_great_misit_liege = ROOT
					is_ai = no
				}
			}
		}
	}
	immediate = {
		save_scope_as = great_misit_liege
		random_vassal = {
			limit = {
				has_relation_great_misit_liege = ROOT
				is_ai = no
			}
			save_scope_as = great_misit
			trigger_event = {
				id = great_misit.0023
				days = 3
			}
		}
	}
}

great_misit.0023 = { #外戚的威势
	type = character_event
	title = great_misit.0023.t
	desc = great_misit.0023.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:spouse
	right_portrait = scope:great_misit_liege
	option = {
		name = great_misit.0023.a
		add_misit_power = { VALUE = 20 }
	}
}

great_misit.0024 = {
	type = character_event
	title = great_misit.0024.t
	desc = great_misit.0024.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:actor
	right_portrait = scope:recipient
	option = {
		name = great_misit.0024.a
		scope:actor = {
			add_trait = great_misit_administrative
			vassal_contract_set_obligation_level = {
				type = coinage_rights
				level = 1
			}
			hidden_effect = { set_subject_contract_modification_blocked = no }
		}
	}
}

great_misit.0025 = {
	type = character_event
	title = great_misit.0025.t
	desc = great_misit.0025.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:actor
	right_portrait = scope:recipient
	option = {
		name = great_misit.0025.a
		scope:actor = {
			add_trait = great_misit_audience
			vassal_contract_set_obligation_level = {
				type = council_rights
				level = 1
			}
			hidden_effect = { set_subject_contract_modification_blocked = no }
		}
	}
}

# another vassal inherit a title
great_misit.0026 = {
	type = character_event
	hidden = yes
	trigger = {
		is_independent_ruler = no
		scope:title = {
			tier > tier_county
			is_landless_type_title = no
		}
		is_great_misit_trigger = no
		NOT = { has_trait = great_misit_audience }
		liege = {
			any_vassal = {
				has_trait = great_misit_audience
				is_ai = no
			}
		}
	}
	immediate = {
		save_scope_as = title_viceroy
		liege = {
			save_scope_as = great_misit_liege
		}
		scope:great_misit_liege = {
			random_vassal = {
				limit = {
					has_trait = great_misit_audience
					is_ai = no
				}
				save_scope_as = great_misit
				trigger_event = {
					id = great_misit.0027
					days = 5
				}
			}
		}
	}
}

great_misit.0027 = {
	type = character_event
	title = great_misit.0027.t
	desc = great_misit.0027.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:title_viceroy
	option = {
		name = great_misit.0027.a
		add_gold = 50
		scope:title_viceroy = {
			add_opinion = {
				modifier = wsg_xiaozhong_opinion
				target = scope:great_misit
				opinion = 30
			}
		}
	}
	option = {
		name = great_misit.0027.b
		change_influence_or_prestige = { VALUE = -100 }
		duel = {
			skill = intrigue
			target = scope:title_viceroy
			40 = {
				desc = great_misit.0027.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
				}
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0027.a.great
					scope:great_misit = {
						add_pressed_claim = scope:title
					}
					scope:title_viceroy = {
						add_opinion = {
							modifier = angry_opinion
							target = scope:great_misit
							opinion = -40
						}
					}					
				}
			}
			60 = {	
				desc = great_misit.0027.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -4
				}
				min = 30
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0027.a.poor
					scope:great_misit = {
						change_influence_or_prestige = { VALUE = -100 }
					}
					scope:title_viceroy = {
						add_opinion = {
							modifier = angry_opinion
							target = scope:great_misit
							opinion = -40
						}
					}
				}
			}
		}
	}
}

great_misit.0028 = { #打君主
	type = character_event
	title = great_misit.0028.t
	desc = great_misit.0028.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	trigger = {
		great_misit_event_trigger = yes
	}
	immediate = {
		save_scope_as = great_misit
		liege = {
			save_scope_as = great_misit_liege
		}	
	}
	left_portrait = scope:great_misit
	right_portrait = scope:great_misit_liege
	option = {
		name = great_misit.0028.a
		duel = {
			skill = prowess
			target = scope:great_misit_liege
			40 = {
				desc = great_misit.0028.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0028.a.succes
					scope:great_misit = {
						add_misit_power = { VALUE = 20 }
					}
					scope:great_misit_liege = {
						change_influence_or_prestige = { VALUE = -200 }
					}					
				}
			}
			60 = {	
				desc = great_misit.0028.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
				}
				min = 20
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0028.a.lose
					scope:great_misit = {
						add_misit_power = { VALUE = -30 }
						change_influence_or_prestige = { VALUE = -100 }
					}					
				}
			}
		}
	}
}
# deprecated, check trigger before readd it 
great_misit.0029 = { #命运的晚上
	type = character_event
	title = great_misit.0029.t
	desc = great_misit.0029.desc
	orphan = yes
	theme = realm
	override_background = {
		reference = throne_room
	}
	immediate = {
		save_scope_as = great_misit
		play_music_cue = "woaini"
		random_knight = {
			limit = {
				is_female = yes
			}
			save_scope_as = second
		}
		liege = {
			save_scope_as = great_misit_liege
			random_powerful_vassal = {
				limit = {
					this != ROOT
					is_adult = yes
				}
				save_scope_as = first
			}
			random_vassal = {
				limit = {
					this != ROOT
					is_female = no
				}
				save_scope_as = third
			}
		}	
	}
	left_portrait = scope:great_misit
	right_portrait = scope:first
	lower_left_portrait = scope:second
	lower_center_portrait = scope:great_misit_liege
	lower_right_portrait = scope:third
	
	option = {
		name = great_misit.0029.a
		duel = {
			skill = prowess
			target = scope:first
			50 = {
				desc = great_misit.0029.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				trigger_event = {
					id = great_misit.0030
					days = 3
				}
			}
			50 = {	
				desc = great_misit.0029.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
				}
				trigger_event = {
					id = great_misit.0031
					days = 3
				}
			}
		}
	}
	option = {
		name = great_misit.0029.b
		scope:second = {
			duel = {
				skill = prowess
				target = scope:first
				60 = {
					desc = great_misit.0029.a.great
					compare_modifier = {
						value = scope:duel_value
						multiplier = 2
					}
					trigger_event = {
						id = great_misit.0030
						days = 2
					}
				}
				40 = {	
					desc = great_misit.0029.a.poor
					compare_modifier = {
						value = scope:duel_value
						multiplier = -2
					}
					trigger_event = {
						id = great_misit.0031
						days = 3
					}
				}
			}
		}
	}
}

great_misit.0030 = {
	type = character_event
	title = great_misit.0030.t
	desc = great_misit.0030.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:great_misit
	right_portrait = scope:first
	lower_left_portrait = scope:second
	lower_center_portrait = scope:great_misit_liege
	lower_right_portrait = scope:third
	option = {
		name = great_misit.0030.a
		scope:great_misit = {
			add_misit_power = { VALUE = 50 }
			add_pressed_claim = scope:first.primary_title
		}
		scope:first = {
			death = {
				death_reason = death_duel
				killer = scope:second
			}
		}
		scope:great_misit_liege = {
			change_influence_or_prestige = { VALUE = -300 }
		}
	}
}

great_misit.0031 = {
	type = character_event
	title = great_misit.0031.t
	desc = great_misit.0031.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:great_misit
	right_portrait = scope:first
	lower_left_portrait = scope:second
	lower_center_portrait = scope:great_misit_liege
	lower_right_portrait = scope:third
	option = {
		name = great_misit.0031.a
		scope:great_misit = {
			death = {
				death_reason = death_duel
				killer = scope:first
			}
		}
		scope:great_misit_liege = {
			death = {
				death_reason = death_duel
				killer = scope:first
			}
		}
		scope:first = {
			change_influence_or_prestige = { VALUE = 500 }
		}
	}
}

great_misit.0032 = { #罗马法的基石
	type = character_event
	title = great_misit.0032.t
	desc = great_misit.0032.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	trigger = {
		great_misit_event_trigger = yes
	}
	immediate = {
		save_scope_as = great_misit
		liege = {
			save_scope_as = great_misit_liege
		}	
	}
	left_portrait = scope:great_misit
	right_portrait = scope:great_misit_liege
	option = {
		name = great_misit.0032.a
		duel = {
			skill = stewardship
			target = scope:great_misit_liege
			50 = {
				desc = great_misit.0032.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
				}
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0032.a.success
					scope:great_misit = {
						add_misit_power = { VALUE = 20 }
					}
					scope:great_misit_liege = {
						change_influence_or_prestige = { VALUE = -200 }
					}					
				}
			}
			50 = {	
				desc = great_misit.0032.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3
				}
				min = 20
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0032.a.failure
					scope:great_misit = {
						add_misit_power = { VALUE = -30 }
						change_influence_or_prestige = { VALUE = -100 }
					}					
				}
			}
		}
	}
}

great_misit.0033 = { #演讲
	type = character_event
	title = great_misit.0033.t
	desc = great_misit.0033.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	trigger = {
		great_misit_event_trigger = yes
	}
	immediate = {
		save_scope_as = great_misit
		liege = {
			save_scope_as = great_misit_liege
		}	
	}
	left_portrait = scope:great_misit
	right_portrait = scope:great_misit_liege
	option = {
		name = great_misit.0033.a
		duel = {
			skill = diplomacy
			target = scope:great_misit_liege
			60 = {
				desc = great_misit.0033.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0033.a.success
					scope:great_misit = {
						add_misit_power = { VALUE = 20 }
					}
					scope:great_misit_liege = {
						change_influence_or_prestige = { VALUE = -200 }
					}					
				}
			}
			40 = {	
				desc = great_misit.0033.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
				}
				min = 20
				send_interface_toast = {
					left_icon = scope:great_misit
					right_icon = scope:great_misit_liege
					title = great_misit.0033.a.failure
					scope:great_misit = {
						add_misit_power = { VALUE = -30 }
						change_influence_or_prestige = { VALUE = -100 }
					}					
				}
			}
		}
	}
}

great_misit.0034 = { #西比西比第一步：宴会
	type = character_event
	title = great_misit.0034.t
	desc = great_misit.0034.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:shoujingsi
	right_portrait = scope:cuidaixing
	trigger = {
		liege = {
			any_vassal = {
				is_powerful_vassal = yes
				# is_hm_religion = no
				this != ROOT
				sub_realm_size >= 10
				is_available_adult = yes
			}
		}
	}
	on_trigger_fail = {
		liege = {
			save_scope_as = great_misit_liege
		}
		become_great_misit_effect = yes
	}
	immediate = {
		save_scope_as = baoansi
		liege = {
			save_scope_as = cuidaixing
			random_vassal = {
				limit = {
					is_powerful_vassal = yes
					# is_hm_religion = no
					this != ROOT
					sub_realm_size >= 10
					is_available_adult = yes
				}
				save_scope_as = shoujingsi
			}
		}
	}
	option = {
		name = great_misit.0034.a
		duel = {
			skill = diplomacy
			target = scope:shoujingsi
			50 = {
				desc = great_misit.0034.a.success
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
				}
				trigger_event = {
					id = great_misit.0035
					days = 3
				}
			}
			50 = {	
				desc = great_misit.0034.a.failure
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3
				}
				min = 20
				trigger_event = {
					id = great_misit.0036
					days = 3
				}
			}
		}
	}
}

great_misit.0035 = { #宴会成功
	type = character_event
	title = great_misit.0035.t
	desc = great_misit.0035.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:shoujingsi
	right_portrait = scope:baoansi
	option = {
		name = great_misit.0035.a
		trigger_event = {
			id = great_misit.0037
			days = 3
		}
	}
}

great_misit.0036 = { #宴会失败
	type = character_event
	title = great_misit.0036.t
	desc = great_misit.0036.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:shoujingsi
	right_portrait = scope:baoansi
	option = {
		name = great_misit.0036.a
		trigger_event = {
			id = great_misit.0037
			days = 3
		}
		scope:shoujingsi = {
			spawn_army = {
				uses_supply = no
				inheritable = yes
				name = unionfleet_event_troops
				men_at_arms = {
					type = bowmen
					stacks = 15
				}
				location = capital_province
			}
			spawn_army = {
				uses_supply = no
				inheritable = yes
				name = unionfleet_event_troops
				men_at_arms = {
					type = bowmen
					stacks = 15
				}
				location = capital_province
			}
			spawn_army = {
				uses_supply = no
				inheritable = yes
				name = unionfleet_event_troops
				men_at_arms = {
					type = bowmen
					stacks = 15
				}
				location = capital_province
			}
		}
	}
}

great_misit.0037 = { #控制君主
	type = character_event
	title = great_misit.0037.t
	desc = great_misit.0037.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:baoansi
	right_portrait = scope:cuidaixing
	option = {
		name = great_misit.0034.a
		duel = {
			skill = martial
			target = scope:cuidaixing
			50 = {
				desc = great_misit.0037.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
				}
				trigger_event = {
					id = great_misit.0038
					days = 3
				}
			}
			50 = {	
				desc = great_misit.0037.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3
				}
				min = 20
				trigger_event = {
					id = great_misit.0039
					days = 3
				}
			}
		}
	}
}

great_misit.0038 = { #逮捕成功
	type = character_event
	title = great_misit.0038.t
	desc = great_misit.0038.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:cuidaixing
	right_portrait = scope:baoansi
	option = {
		name = great_misit.0038.a
		trigger_event = {
			id = great_misit.0040
			days = 3
		}
	}
}

great_misit.0039 = { #逮捕失败
	type = character_event
	title = great_misit.0039.t
	desc = great_misit.0039.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:cuidaixing
	right_portrait = scope:baoansi
	option = {
		name = great_misit.0039.a
		trigger_event = {
			id = great_misit.0040
			days = 3
		}
		scope:shoujingsi = {
			spawn_army = {
				uses_supply = no
				inheritable = yes
				name = unionfleet_event_troops
				men_at_arms = {
					type = light_horsemen
					stacks = 15
				}
				location = capital_province
			}
			spawn_army = {
				uses_supply = no
				inheritable = yes
				name = unionfleet_event_troops
				men_at_arms = {
					type = light_horsemen
					stacks = 15
				}
				location = capital_province
			}
			spawn_army = {
				uses_supply = no
				inheritable = yes
				name = unionfleet_event_troops
				men_at_arms = {
					type = light_horsemen
					stacks = 15
				}
				location = capital_province
			}
		}
	}
}

great_misit.0040 = { #电信诈骗
	type = character_event
	title = great_misit.0040.t
	desc = great_misit.0040.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	immediate = {
		scope:cuidaixing = {
			random_knight = {
				save_scope_as = yincizhang
			}
		}	
	}
	left_portrait = scope:baoansi
	right_portrait = scope:yincizhang
	option = {
		name = great_misit.0040.a
		duel = {
			skill = intrigue
			target = scope:yincizhang
			50 = {
				desc = great_misit.0040.a.great
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
				}
				trigger_event = {
						id = great_misit.0041
						days = 3
				}
			}
			50 = {	
				desc = great_misit.0040.a.poor
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3
				}
				min = 20
				trigger_event = {
						id = great_misit.0042
						days = 3
				}
			}
		}
	}
}
great_misit.0041 = { #诈骗成功
	type = character_event
	title = great_misit.0041.t
	desc = great_misit.0041.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:yincizhang
	right_portrait = scope:baoansi
	option = {
		name = great_misit.0041.a
		trigger_event = {
			id = great_misit.0043
			days = 3
		}
	}
}
great_misit.0042 = { #诈骗失败
	type = character_event
	title = great_misit.0041.t
	desc = great_misit.0041.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	left_portrait = scope:yincizhang
	right_portrait = scope:baoansi
	option = {
		name = great_misit.0042.a
		trigger_event = {
			id = great_misit.0043
			days = 3
		}
		scope:shoujingsi = {
			spawn_army = {
				uses_supply = no
				inheritable = yes
				name = unionfleet_event_troops
				men_at_arms = {
					type = armored_footmen
					stacks = 15
				}
				location = capital_province
			}
			spawn_army = {
				uses_supply = no
				inheritable = yes
				name = unionfleet_event_troops
				men_at_arms = {
					type = armored_footmen
					stacks = 15
				}
				location = capital_province
			}
			spawn_army = {
				uses_supply = no
				inheritable = yes
				name = unionfleet_event_troops
				men_at_arms = {
					type = armored_footmen
					stacks = 15
				}
				location = capital_province
			}
		}
	}
	
}

great_misit.0043 = { #看我派部队把你们统统送上天
	type = character_event
	title = great_misit.0043.t
	desc = great_misit.0043.desc
	theme = realm
	override_background = {
		reference = throne_room
	}
	immediate = {
		play_music_cue = "Deus_Non_Vult"
	}
	right_portrait = scope:baoansi
	left_portrait = scope:shoujingsi
	option = {
		name = great_misit.0043.a
		scope:baoansi = {
			start_war = {
				cb = xibixibi_realm_invasion_war
				target = scope:shoujingsi
				target_title = scope:shoujingsi.top_liege.primary_title
			}
		}
	}
}

great_misit.0044 = { #宫相大胜利
	type = character_event
	title = great_misit.0044.t
	desc = great_misit.0044.desc
	theme = realm
	override_background = {
		reference = hm_guard
	}
	immediate = {
		save_scope_as = great_misit
		play_music_cue = "Deus_Non_Vult"
		add_character_flag = super_event_great_misit_deus
		liege = {
			save_scope_as = great_misit_liege
		}
	}
	right_portrait = scope:great_misit
	left_portrait = scope:defender
	option = {
		name = great_misit.0044.a
		become_great_misit_effect = yes
	}
}

# become great misit
great_misit.1000 = {
	type = character_event
	title = great_misit.1000.t
	desc = great_misit.1000.desc
	theme = realm
	left_portrait = scope:great_misit
	override_background = {
		reference = throne_room
	}
	immediate = {
		save_scope_as = great_misit
		play_music_cue_once = { TRACK = Deus_Non_Vult }
		add_character_flag = xibixibi
	}
	option = {
		name = great_misit.1000.a
		trigger = {
			liege = {
				NOT = { 
					any_vassal = {
						is_powerful_vassal = yes
						is_ai = yes
						sub_realm_size >= 10
						is_available_adult = yes
					}
				}	
			}
		}
		liege = {
			save_scope_as = great_misit_liege
		}
		become_great_misit_effect = yes
	}
	option = {
		name = great_misit.1000.b
		trigger = {
			liege = {
				any_vassal = { 
					is_powerful_vassal = yes
					is_ai = yes
					sub_realm_size >= 10
					is_available_adult = yes
				} 
			}
		}
		trigger_event = {
			id = great_misit.0034
			days = 3
		}
	}
}
# deprecated. a peace version?
great_misit.1001 = {
	type = character_event
	title = great_misit.1000.t
	desc = great_misit.1000.desc
	theme = realm
	orphan = yes
	left_portrait = scope:great_misit
	override_background = {
		reference = throne_room
	}
	trigger = {
		is_great_misit_trigger = yes 
	}
	immediate = {
		become_great_misit_effect = yes
	}
	option = {
		name = great_misit.1000.a
		misit_power_value_effect = yes
	}
}

# great misit died
great_misit.1010 = {
	type = character_event
	hidden = yes
	trigger = {
		has_trait = great_misit
		is_independent_ruler = no
	}
	immediate = {
		if = {
			limit = { exists = designated_heir }
			designated_heir = {
				set_relation_great_misit_liege = root.liege
			}
		}
		else_if = {
			limit = { exists = primary_heir }
			primary_heir = {
				set_relation_great_misit_liege = root.liege
			}
		}
		else_if = {
			limit = { exists = player_heir }
			player_heir = {
				set_relation_great_misit_liege = root.liege
			}
		}
	}
}
# liege died
great_misit.1011 = {
	type = character_event
	title = great_misit.1011.t
	desc = great_misit.1011.desc
	theme = realm
	left_portrait = scope:great_misit
	override_background = {
		reference = throne_room
	}
	trigger = {
		any_vassal = {
			is_great_misit_trigger = yes
		}
	}
	immediate = {
		every_vassal = { 
			limit = { is_great_misit_trigger = yes }
			save_scope_as = great_misit
			trigger_event = {
				id = great_misit.1012
				delayed = yes
			}
		} 	
	}
	option = {
		name = great_misit.1011.a
	}	
}

# inform misit the liege died
great_misit.1012 = {
	type = character_event
	title = great_misit.1011.t
	desc = great_misit.1011.desc
	theme = realm
	left_portrait = scope:great_misit
	override_background = {
		reference = throne_room
	}
	trigger = {
		# is_great_misit_trigger = yes
	}
	immediate = {
		play_music_cue_once = { TRACK = Deus_Non_Vult }
		become_great_misit_effect = yes
	}
	option = {
		name = great_misit.1011.a
		misit_power_prestige_level_value_effect = yes
	}	
}

# join liege aggresive war
great_misit.1020 = {
	type = character_event
	title = great_misit.1021.t
	desc = great_misit.1020.desc
	theme = realm
	left_portrait = scope:great_misit_liege
	right_portrait = scope:defender
	override_background = {
		reference = throne_room
	}
	trigger = {
		is_great_misit_trigger = yes
	}
	option = {
		name = great_misit.1021.a
		scope:war = {
			add_attacker = root
		}
		add_misit_power = { VALUE = 10 }
	}	
	option = {
		name = great_misit.1021.b
	}
}
# join liege defensive war
great_misit.1021 = {
	type = character_event
	title = great_misit.1021.t
	desc = great_misit.1021.desc
	theme = realm
	left_portrait = scope:great_misit_liege
	right_portrait = scope:attacker
	override_background = {
		reference = throne_room
	}
	trigger = {
		is_great_misit_trigger = yes
	}
	option = {
		name = great_misit.1021.a
		scope:war = {
			add_defender = root
		}
		add_misit_power = { VALUE = 10 }
	}	
	option = {
		name = great_misit.1021.b
	}
}
