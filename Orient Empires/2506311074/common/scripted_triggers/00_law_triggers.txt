
character_gender_can_rule_title_trigger = {
	trigger_if = {
		limit = {
			$GENDER$ = { is_male = yes }
			exists = $TITLE$
			$TITLE$ = {
				NOT = {
					has_title_law = female_only_law
				}
			}
		}
		always = yes
	}
	trigger_else_if = {
		limit = {
			$GENDER$ = { is_female = yes }
			exists = $TITLE$
			$TITLE$ = {
				NOT = {
					has_title_law = male_only_law
				}
			}
		}
		always = yes
	}
	trigger_else = {
		always = no
	}
}

character_gender_can_inherit_from_trigger = {
	save_temporary_scope_as = heir

	trigger_if = {
		limit = {
			$CHARACTER$ = { exists = primary_title }
		}
		$CHARACTER$ = {
			character_gender_can_rule_title_trigger = {
				GENDER = scope:heir
				TITLE = primary_title
			}
		}
	}
	trigger_else = {
		always = no
	}
}

has_partition_succession_realm_law_trigger = {
	OR = {
		has_realm_law = confederate_partition_succession_law
		has_realm_law = partition_succession_law
		has_realm_law = high_partition_succession_law
		has_realm_law = clan_antagonistic_partition_succession_law
		has_realm_law = clan_competitive_partition_succession_law
		has_realm_law = clan_impassive_partition_succession_law
		has_realm_law = clan_friendly_partition_succession_law
		has_realm_law = clan_harmonious_partition_succession_law
	}
}

realm_law_use_crown_authority = {
	# We separate this out into a different trigger for moddability purposes, per community request: this allows more diverse authority laws to be easily modded in without needing to override 00_realm_laws.txt, and thus for greater inter-mod compatibility.
	realm_law_use_tribal_authority = no
	realm_law_use_camp_purpose = no
	realm_law_use_imperial_bureaucracy = no
}

realm_law_use_tribal_authority = {
	OR = {
		government_has_flag = government_is_tribal
		government_has_flag = government_is_ulus
	}
}

realm_law_use_camp_purpose = {
	government_has_flag = government_is_landless_adventurer
}

realm_law_use_imperial_bureaucracy = {
	government_allows = administrative
}

can_have_confederate_partition_succession_law_trigger = {
	OR = {
		government_has_flag = government_is_feudal
		government_has_flag = government_is_tribal
	}
}

can_keep_partition_succession_law_trigger = {
	# The 'can_keep' triggers are dependent on actually having the law. If they aren't, the trigger breakdown for the player breaks and shows incomplete information.
	trigger_if = {
		limit = {
			has_realm_law = partition_succession_law
		}
		OR = {
			can_have_partition_succession_law_trigger = yes

			# Mongol Empires
			has_title = title:e_mongol_empire
			has_title = title:e_ilkhanate
			has_title = title:e_golden_horde
			has_title = title:e_chagatai
			has_title = title:e_black_horde
			has_title = title:e_white_horde
			has_title = title:e_aarlud_khanate
			has_title = title:e_togskol_khanate
			has_title = title:e_baruun_khanate
		}
	}
	NOT = { government_has_flag = government_is_clan }
}

can_have_partition_succession_law_trigger = {
	culture = {
		has_innovation = innovation_hereditary_rule
	}
	custom_description = {
		text = succession_laws_must_have_organised_government_tooltip
		OR = {
			government_has_flag = government_is_feudal
		}
	}
}

can_keep_high_partition_succession_law_trigger = {
	# The 'can_keep' triggers are dependent on actually having the law. If they aren't, the trigger breakdown for the player breaks and shows incomplete information.
	trigger_if = {
		limit = {
			has_realm_law = high_partition_succession_law
		}
		OR = {
			can_have_high_partition_succession_law_trigger = yes

			# Mongol Empires
			has_title = title:e_mongol_empire
			has_title = title:e_ilkhanate
			has_title = title:e_golden_horde
			has_title = title:e_chagatai
			has_title = title:e_black_horde
			has_title = title:e_white_horde
			has_title = title:e_aarlud_khanate
			has_title = title:e_togskol_khanate
			has_title = title:e_baruun_khanate
			has_title = title:e_cathay
			has_title = title:k_khitan

			is_royal_government_trigger = yes
		}
	}
	NOT = { government_has_flag = government_is_clan}
}

can_have_high_partition_succession_law_trigger = {
	trigger_if = {
		limit = {
			NOT = { 
				culture = { has_cultural_parameter = can_enact_high_partition_succession_law }
			}
		}
		culture = { has_innovation = innovation_heraldry }
	}
	custom_description = {
		text = succession_laws_must_have_organised_government_tooltip
		OR = {
			government_has_flag = government_is_feudal
			government_has_flag = government_is_ulus
			government_has_flag = government_is_legion
			is_royal_government_trigger = yes
		}
	}
}

can_keep_single_heir_succession_law_trigger = {
	# The 'can_keep' triggers are dependent on actually having the law. If they aren't, the trigger breakdown for the player breaks and shows incomplete information.
	trigger_if = {
		limit = {
			has_realm_law = single_heir_succession_law
		}
		OR = {
			can_have_single_heir_succession_law_trigger = yes
			# Byzantine Empire
			historical_succession_access_single_heir_succession_law_trigger = yes
		}
	}
}

can_have_single_heir_succession_law_trigger = {
	OR = {
		culture = {
			has_innovation = innovation_primogeniture
		}
		# Non-tribals only
		custom_description = {
			text = succession_laws_must_have_organised_government_tooltip
			OR = {
				government_has_flag = government_is_feudal
				government_has_flag = government_is_clan
				AND = {
					government_has_flag = government_is_celestial
					is_independent_ruler = yes
				}
				government_has_flag = government_is_ulus
				government_has_flag = government_is_legion
			}
		}	
		AND = {
			culture = { has_cultural_parameter = patriarch_society }  #宗法制 改为革新
			is_independent_ruler = yes
		}
		culture = {
			has_innovation = innovation_world_cathay
		}
		has_title = title:d_tianshi
		has_title = title:d_gosho

	}
	NOT = { government_allows = administrative }
}

can_keep_single_heir_youngest_succession_law_trigger = {
	# The 'can_keep' triggers are dependent on actually having the law. If they aren't, the trigger breakdown for the player breaks and shows incomplete information.
	trigger_if = {
		limit = {
			has_realm_law = single_heir_succession_law_youngest
		}
		OR = {
			can_have_single_heir_youngest_succession_law_trigger = yes
			historical_succession_access_single_heir_succession_law_youngest_trigger = yes
		}
	}
}

can_have_single_heir_youngest_succession_law_trigger = {
	culture = {
		has_innovation = innovation_primogeniture
	}
	# Non-tribals only
	custom_description = {
		text = succession_laws_must_have_organised_government_tooltip
		OR = {
			government_has_flag = government_is_feudal
			government_has_flag = government_is_clan
			government_has_flag = government_is_ulus
		}
	}
	NOT = { government_allows = administrative }
}

can_keep_single_heir_dynasty_house_trigger = {
	# The 'can_keep' triggers are dependent on actually having the law. If they aren't, the trigger breakdown for the player breaks and shows incomplete information.
	trigger_if = {
		limit = {
			has_realm_law = single_heir_dynasty_house
		}
		OR = {
			can_have_single_heir_dynasty_house_trigger = yes
			historical_succession_access_single_heir_dynasty_house_trigger = yes
		}
	}
}

can_have_single_heir_dynasty_house_trigger = {
	exists = house
	trigger_if = {
		limit = {
			culture = {
				OR = {
					has_cultural_pillar = heritage_west_slavic
					NOT = {	has_innovation = innovation_heraldry }
				}
			}
		}
		culture = {
			has_innovation = innovation_table_of_princes
		}
	}
	trigger_else_if = {
		limit = {
			culture = {
				OR = {
					has_cultural_pillar = heritage_tunguse
					has_cultural_pillar = heritage_mongolic
				}
			}
		}
		culture = {
			has_cultural_parameter = unlock_maa_asia_tunguse_ss
		}
	}
	trigger_else = {
		culture = {
			has_innovation = innovation_heraldry
		}
	}
	custom_description = {
		text = succession_laws_must_have_organised_government_tooltip
		OR = {
			government_has_flag = government_is_feudal
			government_has_flag = government_is_clan
			government_has_flag = government_is_tribal
		}
	}
	NOT = { government_allows = administrative }
}

can_have_bishop_theocratic_succession_law_trigger = {
	OR = {
		is_theocratic_lessee = yes
		government_has_flag = government_is_theocracy
	}
}

is_temporal_head_of_faith_trigger = {
	holder = {
		NOR = {
			government_has_flag = government_is_celestial
			faith = { religion_tag = confucianism_religion }
			faith = { religion_tag = shinto_religion }
			faith = { religion_tag = taoism_religion }
		}
	}
	is_head_of_faith = yes
	holder.faith = { has_doctrine = doctrine_temporal_head }
}

can_title_have_law_general_trigger = {
	tier >= tier_duchy
	is_temporal_head_of_faith_trigger = no
}

can_have_holy_order_succession_law_trigger = {
	government_has_flag = government_is_holy_order
}

can_have_mercenary_succession_law_trigger = {
	government_has_flag = government_is_mercenary
}

can_have_city_succession_law_trigger = {
	government_has_flag = government_is_republic
}

title_can_reduce_partition_law_trigger = {
	OR = {
		AND = {
			has_realm_law = single_heir_succession_law
			holder = {
				can_have_high_partition_succession_law_trigger = yes
			}
		}
		AND = {
			has_realm_law = high_partition_succession_law
			holder = {
				can_have_high_partition_succession_law_trigger = yes
			}
		}
		AND = {
			has_realm_law = partition_succession_law
			holder = {
				can_have_confederate_partition_succession_law_trigger = yes
			}
		}
	}
}

can_pass_law_ca1_trigger = {
	culture = { has_innovation = innovation_plenary_assemblies }
}

can_pass_law_ca2_trigger = {
	OR = {
		culture = { has_innovation = innovation_royal_prerogative }
		culture = { has_cultural_parameter = patriarch_society } #宗法细化
	}
}

can_pass_law_ca3_trigger = {
	OR = {
		culture = { has_innovation = innovation_royal_prerogative }
		culture = { has_cultural_parameter = patriarch_society } #宗法细化
	}
}

can_have_acclamation_succession_law_trigger = {
	has_ep3_dlc_trigger = yes
	government_allows = administrative
	is_independent_ruler = yes
	NOT = { government_has_flag = government_is_celestial }
}

can_keep_acclamation_succession_law_trigger = {
	has_ep3_dlc_trigger = yes
	trigger_if = {
		limit = {
			has_realm_law = acclamation_succession_law 
		}
		OR = {
			can_have_acclamation_succession_law_trigger = yes
			has_title = title:e_byzantium
		}
	}
}

can_change_acclamation_succession_law_trigger = {
	has_ep3_dlc_trigger = yes
}


#流官制（与帝国官僚继承法接驳）
can_have_official_succession_law_trigger = {
	government_has_flag = government_is_celestial
	is_independent_ruler = no
	highest_held_title_tier > tier_county
	primary_title = {
		tier > tier_county
		is_oe_noble_family_title = no
	}
	NOR = {
		vassal_contract_has_flag = imperial_legion_3
		vassal_contract_has_flag = imperial_royal_1
		vassal_contract_has_flag = heir_succession_rights_unlock
		primary_title = { has_variable = titular_title }
		has_title = title:d_gosho 
	}
}

can_keep_official_succession_law_trigger = {
	trigger_if = {
		limit = {
			has_realm_law = official_succession_law
		}
		can_have_official_succession_law_trigger = yes
	}
	#trigger_if = {
		#limit = {
			#highest_held_title_tier = tier_kingdom
		#}
		#OR = {
			#vassal_contract_has_flag = imperial_legion_4
			#top_liege = { is_oe_imperial_government_trigger = no }
			#culture = { has_innovation = innovation_court_officials }
			#top_liege = { culture = { has_innovation = innovation_court_officials } }
		#}
	#}
}


can_pass_official_succession_law_trigger = {
	can_change_title_law_trigger = yes
	can_have_official_succession_law_trigger = yes
}

#宗法指认制
can_have_tradition_succession_law_trigger = {
	OR = {
		government_has_flag = government_is_celestial
		government_has_flag = government_is_ulus
		government_has_flag = government_is_legion
	}
	OR = {
		is_royal_government_trigger = yes
		is_independent_ruler = yes
		is_oe_imperial_official_trigger = yes
		vassal_contract_has_flag = heir_succession_rights_unlock
		has_title = title:d_gosho
		has_title = title:d_sekke
	}	
}

can_keep_tradition_succession_law_trigger = {
	trigger_if = {
		limit = { has_realm_law = tradition_succession_law }
		can_have_tradition_succession_law_trigger = yes
	}
}

can_pass_tradition_succession_law_trigger = {
	can_change_succession_law_trigger = yes
	can_have_tradition_succession_law_trigger = yes
}

#留后册命制（藩镇基础继承法）
can_have_legion_succession_law_trigger = {
	OR = {
		government_has_flag = government_is_legion
		AND = {
			government_has_flag = government_is_celestial
			liege = { NOT = { government_has_flag = government_is_celestial } }
		}
		vassal_contract_has_flag = heir_succession_rights_unlock
	}
}

can_keep_legion_succession_law_trigger = {
	trigger_if = {
		limit = { has_realm_law = legion_succession_law }
		can_have_legion_succession_law_trigger = yes 		
	}
}

can_pass_legion_succession_law_trigger = {
	can_change_title_law_trigger = yes
	can_have_legion_succession_law_trigger = yes
}

#科举制
can_have_admin_succession_law_trigger = {
	is_landed = yes
	highest_held_title_tier <= tier_county
	OR = {
		top_liege ?= {
			government_has_flag = government_is_celestial
		}
		government_has_flag = government_is_bureau
		AND = {
			government_has_flag = government_is_celestial
			is_theocratic_lessee = no
		}	
		AND = {
			is_theocratic_lessee = yes
			religion = religion:confucianism_religion
		}	
	}
	NOR = {
		vassal_contract_has_flag = imperial_legion_3
		vassal_contract_has_flag = imperial_royal_1
		vassal_contract_has_flag = heir_succession_rights_unlock
	}
}

#玩家判定
can_have_official_succession_law_player_trigger = {
	is_independent_ruler = no
	#highest_held_title_tier >= tier_county
	liege ?= {
		OR = {
			government_has_flag = government_is_celestial
			government_has_flag = government_is_bureau
			is_legion_government_trigger = yes
		}
	}
	OR = {
		government_has_flag = government_is_celestial
		government_has_flag = government_is_bureau
		is_legion_government_trigger = yes
	}
	OR = {
		is_ai = no
		has_variable = player_officier
	}
}
#玩家判定
can_keep_official_succession_law_player_trigger = {
	trigger_if = {
		limit = {
			has_realm_law = player_official_succession_law
		}
		is_ai = no
	}
}